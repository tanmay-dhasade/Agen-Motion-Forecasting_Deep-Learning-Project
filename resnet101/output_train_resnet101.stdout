Lmod has detected the following error: The following module(s) are unknown:
"cuda10.0/toolkit/10.0.130"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore-cache load "cuda10.0/toolkit/10.0.130"

Also make sure that all modulefiles written in TCL start with the string
#%Module



Lmod has detected the following error: The following module(s) are unknown:
"cuda10.0/fft/10.0.130"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore-cache load "cuda10.0/fft/10.0.130"

Also make sure that all modulefiles written in TCL start with the string
#%Module



Lmod has detected the following error: The following module(s) are unknown:
"cudnn/7.4.2"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore-cache load "cudnn/7.4.2"

Also make sure that all modulefiles written in TCL start with the string
#%Module



/var/spool/slurm/d/job31090/slurm_script: line 13: /cm/local/apps/cuda/libs/current/bin/nvidia-smi: No such file or directory
/var/spool/slurm/d/job31090/slurm_script: line 14: conda: command not found
Dataset and L5kit are ready !
/home/trdhasade/ExtractedDataset
{'format_version': 4, 'model_params': {'model_architecture': 'resnet101', 'history_num_frames': 10, 'future_num_frames': 50, 'step_time': 0.1, 'render_ego_history': True}, 'raster_params': {'raster_size': [224, 224], 'pixel_size': [0.5, 0.5], 'ego_center': [0.25, 0.5], 'map_type': 'py_semantic', 'satellite_map_key': 'aerial_map/aerial_map.png', 'semantic_map_key': 'semantic_map/semantic_map.pb', 'dataset_meta_key': 'meta.json', 'filter_agents_threshold': 0.5, 'disable_traffic_light_faces': False, 'set_origin_to_bottom': True}, 'train_data_loader': {'key': 'scenes/train.zarr', 'batch_size': 12, 'shuffle': True, 'num_workers': 16}, 'val_data_loader': {'key': 'scenes/validate.zarr', 'batch_size': 12, 'shuffle': False, 'num_workers': 16}, 'train_params': {'checkpoint_every_n_steps': 10000, 'max_num_steps': 50, 'eval_every_n_steps': 10000}}
+------------+------------+------------+---------------+-----------------+----------------------+----------------------+----------------------+---------------------+
| Num Scenes | Num Frames | Num Agents | Num TR lights | Total Time (hr) | Avg Frames per Scene | Avg Agents per Frame | Avg Scene Time (sec) | Avg Frame frequency |
+------------+------------+------------+---------------+-----------------+----------------------+----------------------+----------------------+---------------------+
|   16265    |  4039527   | 320124624  |    38735988   |      112.19     |        248.36        |        79.25         |        24.83         |        10.00        |
+------------+------------+------------+---------------+-----------------+----------------------+----------------------+----------------------+---------------------+
/home/trdhasade/anaconda/envs/py37/lib/python3.7/site-packages/torch/utils/data/dataloader.py:490: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  cpuset_checked))
  0%|          | 0/50 [00:00<?, ?it/s]/home/trdhasade/anaconda/envs/py37/lib/python3.7/site-packages/torch/autograd/__init__.py:175: UserWarning: CUDA initialization: The NVIDIA driver on your system is too old (found version 9020). Please update your GPU driver by downloading and installing a new version from the URL: http://www.nvidia.com/Download/index.aspx Alternatively, go to: https://pytorch.org to install a PyTorch version that has been compiled with your version of the CUDA driver. (Triggered internally at  ../c10/cuda/CUDAFunctions.cpp:112.)
  allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
loss: 178.9119110107422 loss(avg): 178.9119110107422:   0%|          | 0/50 [00:30<?, ?it/s]loss: 178.9119110107422 loss(avg): 178.9119110107422:   2%|▏         | 1/50 [00:30<25:16, 30.96s/it]loss: 157.21897888183594 loss(avg): 168.06544494628906:   2%|▏         | 1/50 [00:42<25:16, 30.96s/it]loss: 157.21897888183594 loss(avg): 168.06544494628906:   4%|▍         | 2/50 [00:42<15:34, 19.46s/it]loss: 44.70176315307617 loss(avg): 126.94421768188477:   4%|▍         | 2/50 [00:53<15:34, 19.46s/it] loss: 44.70176315307617 loss(avg): 126.94421768188477:   6%|▌         | 3/50 [00:53<12:19, 15.73s/it]loss: 9.198372840881348 loss(avg): 97.50775647163391:   6%|▌         | 3/50 [01:04<12:19, 15.73s/it] loss: 9.198372840881348 loss(avg): 97.50775647163391:   8%|▊         | 4/50 [01:04<10:41, 13.94s/it]loss: 65.25079345703125 loss(avg): 91.05636386871338:   8%|▊         | 4/50 [01:16<10:41, 13.94s/it]loss: 65.25079345703125 loss(avg): 91.05636386871338:  10%|█         | 5/50 [01:16<09:44, 12.98s/it]loss: 124.42708587646484 loss(avg): 96.6181508700053:  10%|█         | 5/50 [01:27<09:44, 12.98s/it]loss: 124.42708587646484 loss(avg): 96.6181508700053:  12%|█▏        | 6/50 [01:27<09:05, 12.40s/it]loss: 16.117158889770508 loss(avg): 85.11800915854317:  12%|█▏        | 6/50 [01:38<09:05, 12.40s/it]loss: 16.117158889770508 loss(avg): 85.11800915854317:  14%|█▍        | 7/50 [01:38<08:36, 12.00s/it]loss: 30.382535934448242 loss(avg): 78.27607500553131:  14%|█▍        | 7/50 [01:49<08:36, 12.00s/it]loss: 30.382535934448242 loss(avg): 78.27607500553131:  16%|█▌        | 8/50 [01:49<08:15, 11.79s/it]loss: 63.633514404296875 loss(avg): 76.64912382761638:  16%|█▌        | 8/50 [02:01<08:15, 11.79s/it]loss: 63.633514404296875 loss(avg): 76.64912382761638:  18%|█▊        | 9/50 [02:01<07:55, 11.60s/it]loss: 24.29641342163086 loss(avg): 71.41385278701782:  18%|█▊        | 9/50 [02:12<07:55, 11.60s/it] loss: 24.29641342163086 loss(avg): 71.41385278701782:  20%|██        | 10/50 [02:12<07:40, 11.51s/it]loss: 124.85191345214844 loss(avg): 76.2718583020297:  20%|██        | 10/50 [02:23<07:40, 11.51s/it]loss: 124.85191345214844 loss(avg): 76.2718583020297:  22%|██▏       | 11/50 [02:23<07:25, 11.43s/it]loss: 143.4678192138672 loss(avg): 81.87152171134949:  22%|██▏       | 11/50 [02:35<07:25, 11.43s/it]loss: 143.4678192138672 loss(avg): 81.87152171134949:  24%|██▍       | 12/50 [02:35<07:13, 11.40s/it]loss: 106.13789367675781 loss(avg): 83.73816570868858:  24%|██▍       | 12/50 [02:46<07:13, 11.40s/it]loss: 106.13789367675781 loss(avg): 83.73816570868858:  26%|██▌       | 13/50 [02:46<07:00, 11.37s/it]loss: 154.32603454589844 loss(avg): 88.78015633991787:  26%|██▌       | 13/50 [02:57<07:00, 11.37s/it]loss: 154.32603454589844 loss(avg): 88.78015633991787:  28%|██▊       | 14/50 [02:57<06:49, 11.38s/it]loss: 54.13313674926758 loss(avg): 86.47035503387451:  28%|██▊       | 14/50 [03:08<06:49, 11.38s/it] loss: 54.13313674926758 loss(avg): 86.47035503387451:  30%|███       | 15/50 [03:08<06:36, 11.32s/it]loss: 93.88532257080078 loss(avg): 86.9337905049324:  30%|███       | 15/50 [03:20<06:36, 11.32s/it] loss: 93.88532257080078 loss(avg): 86.9337905049324:  32%|███▏      | 16/50 [03:20<06:23, 11.28s/it]loss: 25.829078674316406 loss(avg): 83.33939569136676:  32%|███▏      | 16/50 [03:31<06:23, 11.28s/it]loss: 25.829078674316406 loss(avg): 83.33939569136676:  34%|███▍      | 17/50 [03:31<06:11, 11.26s/it]loss: 59.39198684692383 loss(avg): 82.0089840888977:  34%|███▍      | 17/50 [03:42<06:11, 11.26s/it]  loss: 59.39198684692383 loss(avg): 82.0089840888977:  36%|███▌      | 18/50 [03:42<06:01, 11.31s/it]loss: 9.26584243774414 loss(avg): 78.18039768620541:  36%|███▌      | 18/50 [03:54<06:01, 11.31s/it]loss: 9.26584243774414 loss(avg): 78.18039768620541:  38%|███▊      | 19/50 [03:54<05:53, 11.41s/it]loss: 11.532217025756836 loss(avg): 74.84798865318298:  38%|███▊      | 19/50 [04:05<05:53, 11.41s/it]loss: 11.532217025756836 loss(avg): 74.84798865318298:  40%|████      | 20/50 [04:05<05:41, 11.37s/it]loss: 13.027982711791992 loss(avg): 71.90417884645008:  40%|████      | 20/50 [04:16<05:41, 11.37s/it]loss: 13.027982711791992 loss(avg): 71.90417884645008:  42%|████▏     | 21/50 [04:16<05:28, 11.33s/it]loss: 19.364233016967773 loss(avg): 69.51599949056452:  42%|████▏     | 21/50 [04:28<05:28, 11.33s/it]loss: 19.364233016967773 loss(avg): 69.51599949056452:  44%|████▍     | 22/50 [04:28<05:16, 11.29s/it]loss: 63.94788360595703 loss(avg): 69.27390749558158:  44%|████▍     | 22/50 [04:39<05:16, 11.29s/it] loss: 63.94788360595703 loss(avg): 69.27390749558158:  46%|████▌     | 23/50 [04:39<05:03, 11.25s/it]loss: 44.18837356567383 loss(avg): 68.22867691516876:  46%|████▌     | 23/50 [04:50<05:03, 11.25s/it]loss: 44.18837356567383 loss(avg): 68.22867691516876:  48%|████▊     | 24/50 [04:50<04:51, 11.22s/it]loss: 19.356538772583008 loss(avg): 66.27379138946533:  48%|████▊     | 24/50 [05:01<04:51, 11.22s/it]loss: 19.356538772583008 loss(avg): 66.27379138946533:  50%|█████     | 25/50 [05:01<04:40, 11.22s/it]loss: 53.841529846191406 loss(avg): 65.7956274839548:  50%|█████     | 25/50 [05:12<04:40, 11.22s/it] loss: 53.841529846191406 loss(avg): 65.7956274839548:  52%|█████▏    | 26/50 [05:12<04:29, 11.24s/it]loss: 31.774675369262695 loss(avg): 64.53559222044768:  52%|█████▏    | 26/50 [05:24<04:29, 11.24s/it]loss: 31.774675369262695 loss(avg): 64.53559222044768:  54%|█████▍    | 27/50 [05:24<04:19, 11.30s/it]loss: 14.6334228515625 loss(avg): 62.753371885844636:  54%|█████▍    | 27/50 [05:35<04:19, 11.30s/it] loss: 14.6334228515625 loss(avg): 62.753371885844636:  56%|█████▌    | 28/50 [05:35<04:07, 11.23s/it]loss: 48.439266204833984 loss(avg): 62.259782034775306:  56%|█████▌    | 28/50 [05:46<04:07, 11.23s/it]loss: 48.439266204833984 loss(avg): 62.259782034775306:  58%|█████▊    | 29/50 [05:46<03:57, 11.29s/it]loss: 61.72832107543945 loss(avg): 62.24206666946411:  58%|█████▊    | 29/50 [05:58<03:57, 11.29s/it]  loss: 61.72832107543945 loss(avg): 62.24206666946411:  60%|██████    | 30/50 [05:58<03:46, 11.30s/it]loss: 58.16413497924805 loss(avg): 62.11052048590876:  60%|██████    | 30/50 [06:09<03:46, 11.30s/it]loss: 58.16413497924805 loss(avg): 62.11052048590876:  62%|██████▏   | 31/50 [06:09<03:34, 11.29s/it]loss: 38.05922317504883 loss(avg): 61.35891744494438:  62%|██████▏   | 31/50 [06:20<03:34, 11.29s/it]loss: 38.05922317504883 loss(avg): 61.35891744494438:  64%|██████▍   | 32/50 [06:20<03:23, 11.29s/it]loss: 81.56773376464844 loss(avg): 61.971305818268746:  64%|██████▍   | 32/50 [06:31<03:23, 11.29s/it]loss: 81.56773376464844 loss(avg): 61.971305818268746:  66%|██████▌   | 33/50 [06:31<03:11, 11.24s/it]loss: 22.3494815826416 loss(avg): 60.805958046632654:  66%|██████▌   | 33/50 [06:43<03:11, 11.24s/it] loss: 22.3494815826416 loss(avg): 60.805958046632654:  68%|██████▊   | 34/50 [06:43<02:59, 11.25s/it]loss: 49.457061767578125 loss(avg): 60.4817038672311:  68%|██████▊   | 34/50 [06:54<02:59, 11.25s/it]loss: 49.457061767578125 loss(avg): 60.4817038672311:  70%|███████   | 35/50 [06:54<02:48, 11.26s/it]loss: 30.744712829589844 loss(avg): 59.65567633840773:  70%|███████   | 35/50 [07:05<02:48, 11.26s/it]loss: 30.744712829589844 loss(avg): 59.65567633840773:  72%|███████▏  | 36/50 [07:05<02:37, 11.26s/it]loss: 18.548696517944336 loss(avg): 58.54467688380061:  72%|███████▏  | 36/50 [07:16<02:37, 11.26s/it]loss: 18.548696517944336 loss(avg): 58.54467688380061:  74%|███████▍  | 37/50 [07:16<02:26, 11.24s/it]loss: 49.69685363769531 loss(avg): 58.31183942995573:  74%|███████▍  | 37/50 [07:27<02:26, 11.24s/it] loss: 49.69685363769531 loss(avg): 58.31183942995573:  76%|███████▌  | 38/50 [07:27<02:14, 11.19s/it]loss: 33.809940338134766 loss(avg): 57.68358560708853:  76%|███████▌  | 38/50 [07:39<02:14, 11.19s/it]loss: 33.809940338134766 loss(avg): 57.68358560708853:  78%|███████▊  | 39/50 [07:39<02:03, 11.19s/it]loss: 89.47489929199219 loss(avg): 58.47836844921112:  78%|███████▊  | 39/50 [07:50<02:03, 11.19s/it] loss: 89.47489929199219 loss(avg): 58.47836844921112:  80%|████████  | 40/50 [07:50<01:52, 11.24s/it]loss: 44.73646545410156 loss(avg): 58.14320008347674:  80%|████████  | 40/50 [08:01<01:52, 11.24s/it]loss: 44.73646545410156 loss(avg): 58.14320008347674:  82%|████████▏ | 41/50 [08:01<01:40, 11.14s/it]loss: 45.715843200683594 loss(avg): 57.84731063388643:  82%|████████▏ | 41/50 [08:12<01:40, 11.14s/it]loss: 45.715843200683594 loss(avg): 57.84731063388643:  84%|████████▍ | 42/50 [08:12<01:29, 11.22s/it]loss: 53.72843933105469 loss(avg): 57.75152292916941:  84%|████████▍ | 42/50 [08:23<01:29, 11.22s/it] loss: 53.72843933105469 loss(avg): 57.75152292916941:  86%|████████▌ | 43/50 [08:23<01:18, 11.20s/it]loss: 8.149955749511719 loss(avg): 56.62421458417719:  86%|████████▌ | 43/50 [08:35<01:18, 11.20s/it]loss: 8.149955749511719 loss(avg): 56.62421458417719:  88%|████████▊ | 44/50 [08:35<01:07, 11.19s/it]loss: 11.313773155212402 loss(avg): 55.61731588575575:  88%|████████▊ | 44/50 [08:46<01:07, 11.19s/it]loss: 11.313773155212402 loss(avg): 55.61731588575575:  90%|█████████ | 45/50 [08:46<00:55, 11.19s/it]loss: 4.33530330657959 loss(avg): 54.50248952533888:  90%|█████████ | 45/50 [08:57<00:55, 11.19s/it]  loss: 4.33530330657959 loss(avg): 54.50248952533888:  92%|█████████▏| 46/50 [08:57<00:44, 11.18s/it]loss: 18.40789222717285 loss(avg): 53.73451937005875:  92%|█████████▏| 46/50 [09:08<00:44, 11.18s/it]loss: 18.40789222717285 loss(avg): 53.73451937005875:  94%|█████████▍| 47/50 [09:08<00:33, 11.17s/it]loss: 9.458550453186035 loss(avg): 52.81210335095724:  94%|█████████▍| 47/50 [09:19<00:33, 11.17s/it]loss: 9.458550453186035 loss(avg): 52.81210335095724:  96%|█████████▌| 48/50 [09:19<00:22, 11.17s/it]loss: 20.415361404418945 loss(avg): 52.15094535204829:  96%|█████████▌| 48/50 [09:30<00:22, 11.17s/it]loss: 20.415361404418945 loss(avg): 52.15094535204829:  98%|█████████▊| 49/50 [09:30<00:11, 11.09s/it]loss: 9.982934951782227 loss(avg): 51.30758514404297:  98%|█████████▊| 49/50 [09:41<00:11, 11.09s/it] loss: 9.982934951782227 loss(avg): 51.30758514404297: 100%|██████████| 50/50 [09:41<00:00, 11.06s/it]loss: 9.982934951782227 loss(avg): 51.30758514404297: 100%|██████████| 50/50 [09:41<00:00, 11.63s/it]
